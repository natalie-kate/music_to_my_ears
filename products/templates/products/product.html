{% extends 'base.html' %}
{% load static %}

{% block image %}
<div class="header-container">
  <div class="row">
    <div class="col-12 text-center">
    </div>
  </div>
</div>
{% endblock %}

{% block content %}
<h2 class="text-center mt-4"> Product Details </h2>
<p class="text-center">
  <a href="{% url 'shop' %}">Back to Shop <i class="fas fa-step-backward"></i></a>
</p>

<div class="row">
    <div class="col-10 offset-1 col-md-5 col-lg-4 offset-lg-2">
        <div id="product_details" class="carousel slide mb-3" data-ride="carousel">
            <div class="carousel-inner">
            {% for image in images %}
            <div class="carousel-item">
                <img src="/media/{{ image.image }}" class="d-block w-100"
                    alt="Cover image of {{ product.title }} record">
            </div>
            {% endfor %}
            </div>
            <a class="carousel-control-prev" href="#product_details" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#product_details" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
            </a>
        </div>
        <div class="text-center add-to-basket">
        {% if product.stock_quantity > 0 %}
          {% if basket_product %}
              {% if quantity == product.stock_quantity %}
                <p>You have all the available stock of {{ product.title }} already in your basket.</p> 
              {% else %}
              <p><strong>Price: </strong>£{{ product.price }}</p>
              <form class="form" action="{% url 'add_to_basket' product.id %}" method="POST">
                {% csrf_token %}
                <button type="submit" class="btn btn-md my-btn hover mb-2">Add to Basket</button>
                <input type="hidden" name="redirect_url" value="{{ request.path }}">
              </form>
              {% endif %}
          {% else %}
              <p><strong>Price: </strong>£{{ product.price }}</p>
              <form class="form" action="{% url 'add_to_basket' product.id %}" method="POST">
                {% csrf_token %}
                <button type="submit" class="btn btn-md my-btn hover mb-2">Add to Basket</button>
                <input type="hidden" name="redirect_url" value="{{ request.path }}">
              </form>
          {% endif %}
        {% else %}
        <p>Sorry this is out of stock just now <i class="far fa-sad-cry"></i></p>
        {% endif %}
        
        {% if product.stock_quantity == 1 %}
          <span class="highlight">Hurry only 1 left in stock! <i class="fas fa-running"></i></span>
        {% endif %}
        </div>
    </div>
  
    <div class="col-10 offset-1 col-md-5 col-lg-4 details">
      <div class="text-left">
        <span class="title"><strong>Album Name: </strong> {{ product.title }}</span><br>
        <span class="artist"><strong>Artist: </strong>{{ product.artist }}</span><br>
        <span><strong>Genre: </strong> {{ product.genre.friendly_name }}</span><br>
        <span><strong>Original Release: </strong>{{ product.release_year }}</span><br>
        <span><strong>Description: </strong><br>{{ product.description }}</span><br>
        <span><strong>Track List: </strong><br>
          {% for track in tracklist %}
            <span>{{ track }}</span><br>
          {% endfor %}
      </div>
    </div>
</div>

{% endblock %}

{% block postloadjs %}
{{ block.super }}

<script>
  $(document).ready(function () {
    $(".carousel-inner").children().first().addClass('active')
  });
</script>

{% endblock %}

